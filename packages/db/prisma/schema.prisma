// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider     = "mysql"
    url          = env("DATABASE_URL")
    relationMode = "prisma"
}

model User {
    id                 String               @id
    UserInOrganization UserInOrganization[]
}

model Organization {
    id                 String               @id
    UserInOrganization UserInOrganization[]
    ContainerType      ContainerType[]
    Sensor             Sensor[]
}

model UserInOrganization {
    id             String       @id @default(cuid())
    user           User         @relation(fields: [userId], references: [id])
    userId         String
    organization   Organization @relation(fields: [organizationId], references: [id])
    organizationId String

    @@index([userId])
    @@index([organizationId])
}

model Sensor {
    id           String @id
    name         String
    description  String
    latitude     Float
    longitude    Float
    location     String
    collectionId String

    container   Container @relation(fields: [containerId], references: [id])
    containerId String    @unique

    organization   Organization @relation(fields: [organizationId], references: [id])
    organizationId String
}

model Container {
    id              String        @id @default(cuid())
    containerType   ContainerType @relation(fields: [containerTypeId], references: [id])
    containerTypeId String
    Sensor          Sensor?

    @@index([containerTypeId])
}

model ContainerType {
    id                        String       @id @default(cuid())
    name                      String
    description               String
    targetFillLevelInPercent  Int
    binHeightInMillimeters    Int
    binWidthInMillimeters     Int?         @default(0)
    sensorOffsetInMillimeters Int?         @default(0)
    containerVolumeInLiters   Int?         @default(0)
    organization              Organization @relation(fields: [organizationId], references: [id])
    organizationId            String
    Container                 Container[]

    @@index([organizationId])
}
